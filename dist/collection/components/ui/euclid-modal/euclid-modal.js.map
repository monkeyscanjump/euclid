{"version":3,"file":"euclid-modal.js","sourceRoot":"","sources":["../../../../src/components/ui/euclid-modal/euclid-modal.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, h, State, Listen, Element } from '@stencil/core';\nimport { appStore } from '../../../store/app.store';\n\n@Component({\n  tag: 'euclid-modal',\n  styleUrl: 'euclid-modal.css',\n  shadow: true,\n})\nexport class EuclidModal {\n  @Element() el!: HTMLElement;\n\n  @State() private appState = appStore.state;\n\n  private previousActiveElement: Element | null = null;\n  private previousBodyOverflow: string = '';\n  private previousBodyPaddingRight: string = '';\n  private scrollBarWidth: number = 0;\n\n  componentWillLoad() {\n    console.log('🚀 Modal componentWillLoad');\n    console.log('📊 Initial appState:', this.appState);\n    console.log('📊 Initial store state:', appStore.state);\n\n    // Calculate scrollbar width for body scroll prevention\n    this.scrollBarWidth = this.getScrollBarWidth();\n    console.log('📏 Scrollbar width:', this.scrollBarWidth);\n\n    appStore.onChange('walletModalOpen', () => {\n      console.log('👛 Wallet modal state changed:', appStore.state.walletModalOpen);\n      const wasOpen = this.appState.walletModalOpen || this.appState.tokenModalOpen;\n      const newState = { ...appStore.state };\n      const isNowOpen = newState.walletModalOpen || newState.tokenModalOpen;\n\n      this.appState = newState;\n\n      console.log('👛 Wallet modal state transition:', { wasOpen, isNowOpen });\n      this.handleModalStateChange(wasOpen, isNowOpen);\n    });\n\n    appStore.onChange('tokenModalOpen', () => {\n      console.log('🪙 Token modal state changed:', appStore.state.tokenModalOpen);\n      const wasOpen = this.appState.walletModalOpen || this.appState.tokenModalOpen;\n      const newState = { ...appStore.state };\n      const isNowOpen = newState.walletModalOpen || newState.tokenModalOpen;\n\n      this.appState = newState;\n\n      console.log('🪙 Token modal state transition:', { wasOpen, isNowOpen });\n      this.handleModalStateChange(wasOpen, isNowOpen);\n    });\n  }\n\n  componentDidLoad() {\n    console.log('🎬 componentDidLoad called');\n    // Handle initial state if modal is already open\n    const isOpen = this.appState.walletModalOpen || this.appState.tokenModalOpen;\n    console.log('🎬 componentDidLoad isOpen:', isOpen);\n    if (isOpen) {\n      console.log('🎬 componentDidLoad calling onModalOpen');\n      this.onModalOpen();\n    }\n  }\n\n  disconnectedCallback() {\n    // Cleanup when component is removed\n    this.onModalClose();\n  }\n\n  @Listen('keydown', { target: 'document' })\n  handleKeyDown(event: KeyboardEvent) {\n    const isOpen = this.appState.walletModalOpen || this.appState.tokenModalOpen;\n\n    if (!isOpen) return;\n\n    if (event.key === 'Escape') {\n      this.closeModal();\n    }\n\n    // Focus trapping\n    if (event.key === 'Tab') {\n      this.handleTabKey(event);\n    }\n  }\n\n  private closeModal() {\n    appStore.closeWalletModal();\n    appStore.closeTokenModal();\n  }\n\n  /**\n   * Calculate scrollbar width for cross-framework compatibility\n   */\n  private getScrollBarWidth(): number {\n    if (typeof window === 'undefined') return 0;\n\n    const outer = document.createElement('div');\n    outer.style.visibility = 'hidden';\n    outer.style.overflow = 'scroll';\n    document.body.appendChild(outer);\n\n    const inner = document.createElement('div');\n    outer.appendChild(inner);\n\n    const scrollbarWidth = outer.offsetWidth - inner.offsetWidth;\n    document.body.removeChild(outer);\n\n    return scrollbarWidth;\n  }\n\n  /**\n   * Handle modal state changes (opening/closing)\n   */\n  private handleModalStateChange(wasOpen: boolean, isNowOpen: boolean) {\n    console.log('🔄 handleModalStateChange:', { wasOpen, isNowOpen });\n\n    if (!wasOpen && isNowOpen) {\n      console.log('▶️ Opening modal');\n      this.onModalOpen();\n    } else if (wasOpen && !isNowOpen) {\n      console.log('⏹️ Closing modal');\n      this.onModalClose();\n    } else {\n      console.log('➡️ No state change needed');\n    }\n  }\n\n  /**\n   * SIMPLE AS FUCK body scroll prevention\n   */\n  private onModalOpen() {\n    console.log('🔒 onModalOpen called');\n\n    if (typeof window === 'undefined') {\n      console.log('❌ No window, returning');\n      return;\n    }\n\n    try {\n      // Store current active element\n      this.previousActiveElement = document.activeElement;\n      console.log('💾 Stored active element:', this.previousActiveElement);\n\n      // SIMPLE: Just lock the fucking body scroll\n      const body = document.body;\n      this.previousBodyOverflow = body.style.overflow || '';\n\n      body.style.overflow = 'hidden';\n\n      console.log('🔒 BODY SCROLL LOCKED!', {\n        previousOverflow: this.previousBodyOverflow,\n        newOverflow: body.style.overflow\n      });\n\n      // Focus the modal container\n      requestAnimationFrame(() => {\n        const modalContainer = this.el.shadowRoot?.querySelector('.modal-container') as HTMLElement;\n        if (modalContainer) {\n          modalContainer.focus();\n          console.log('🎯 Modal focused');\n        }\n      });\n\n    } catch (error) {\n      console.error('❌ Error in onModalOpen:', error);\n    }\n  }\n\n  /**\n   * SIMPLE AS FUCK restore body scroll\n   */\n  private onModalClose() {\n    console.log('🔓 onModalClose called');\n\n    if (typeof window === 'undefined') {\n      console.log('❌ No window, returning');\n      return;\n    }\n\n    try {\n      // SIMPLE: Just restore the fucking body scroll\n      const body = document.body;\n      body.style.overflow = this.previousBodyOverflow;\n\n      console.log('🔓 BODY SCROLL RESTORED!', {\n        restoredOverflow: this.previousBodyOverflow,\n        currentOverflow: body.style.overflow\n      });\n\n      // Restore focus to previous element\n      if (this.previousActiveElement && typeof (this.previousActiveElement as HTMLElement).focus === 'function') {\n        (this.previousActiveElement as HTMLElement).focus();\n        console.log('🎯 Focus restored to:', this.previousActiveElement);\n      }\n\n      this.previousActiveElement = null;\n\n    } catch (error) {\n      console.error('❌ Error in onModalClose:', error);\n    }\n  }\n\n  /**\n   * Focus trapping for accessibility\n   */\n  private handleTabKey(event: KeyboardEvent) {\n    const shadowRoot = this.el.shadowRoot;\n    if (!shadowRoot) return;\n\n    const modal = shadowRoot.querySelector('.modal-container');\n    if (!modal) return;\n\n    // Get all focusable elements within the modal (including shadow DOM elements)\n    const focusableElements = modal.querySelectorAll(\n      'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n    );\n\n    if (focusableElements.length === 0) return;\n\n    const firstElement = focusableElements[0] as HTMLElement;\n    const lastElement = focusableElements[focusableElements.length - 1] as HTMLElement;\n\n    // Check if current active element is within our shadow DOM\n    const activeElement = shadowRoot.activeElement || document.activeElement;\n\n    if (event.shiftKey) {\n      // Shift + Tab (backwards)\n      if (activeElement === firstElement || !modal.contains(activeElement)) {\n        lastElement?.focus();\n        event.preventDefault();\n      }\n    } else {\n      // Tab (forwards)\n      if (activeElement === lastElement || !modal.contains(activeElement)) {\n        firstElement?.focus();\n        event.preventDefault();\n      }\n    }\n  }\n\n  private handleOverlayClick = (event: MouseEvent) => {\n    if (event.target === event.currentTarget) {\n      this.closeModal();\n    }\n  };\n\n  render() {\n    const isOpen = this.appState.walletModalOpen || this.appState.tokenModalOpen;\n\n    console.log('🎭 Modal render called:', {\n      isOpen,\n      walletOpen: this.appState.walletModalOpen,\n      tokenOpen: this.appState.tokenModalOpen\n    });\n\n    if (!isOpen) {\n      console.log('🚫 Modal not open, returning null');\n      // Make sure scroll is restored if modal is closed\n      if (document.body.style.overflow === 'hidden') {\n        console.log('🔓 FORCE restoring scroll on closed modal');\n        document.body.style.overflow = this.previousBodyOverflow || '';\n      }\n      return null;\n    }\n\n    // FORCE scroll lock if modal is open (backup safety net)\n    if (document.body.style.overflow !== 'hidden') {\n      console.log('🔒 FORCE locking scroll in render');\n      this.previousBodyOverflow = document.body.style.overflow || '';\n      document.body.style.overflow = 'hidden';\n    }\n\n    let title = '';\n    let content = null;\n\n    if (this.appState.walletModalOpen) {\n      title = 'Connect Wallet';\n      content = <euclid-wallet-content />;\n      console.log('👛 Rendering wallet modal');\n    } else if (this.appState.tokenModalOpen) {\n      title = 'Select Token';\n      content = <euclid-token-content />;\n      console.log('🪙 Rendering token modal');\n    }\n\n    return (\n      <div\n        class=\"modal-overlay\"\n        onClick={this.handleOverlayClick}\n        role=\"dialog\"\n        aria-modal=\"true\"\n        aria-hidden=\"false\"\n      >\n        <div\n          class=\"modal-container\"\n          role=\"document\"\n          tabindex=\"-1\"\n          aria-labelledby=\"modal-title\"\n          aria-describedby=\"modal-content\"\n        >\n          <div class=\"modal-header\">\n            <h2\n              id=\"modal-title\"\n              class=\"modal-title\"\n            >\n              {title}\n            </h2>\n            <button\n              class=\"close-button\"\n              onClick={() => this.closeModal()}\n              type=\"button\"\n              aria-label=\"Close modal\"\n            >\n              <svg viewBox=\"0 0 24 24\" fill=\"currentColor\" aria-hidden=\"true\">\n                <path d=\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z\"/>\n              </svg>\n            </button>\n          </div>\n\n          <div\n            id=\"modal-content\"\n            class=\"modal-content\"\n          >\n            {content}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n"]}