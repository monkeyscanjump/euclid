{"version":3,"file":"market.store.js","sourceRoot":"","sources":["../../src/store/market.store.ts"],"names":[],"mappings":"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","sourcesContent":["import { createStore } from '@stencil/store';\nimport type { EuclidChainConfig, TokenMetadata, PoolInfo } from '../utils/types/api.types';\nimport type { MarketState } from '../utils/types/euclid-api.types';\nimport type { BaseStore } from './types';\n\nconst initialState: MarketState = {\n  chains: [],\n  tokens: [],\n  pools: [],\n  prices: {},\n  loading: false,\n  error: null,\n  lastUpdated: 0,\n};\n\nconst { state, onChange, reset, dispose } = createStore(initialState);\n\n// Actions\nconst actions = {\n  setLoading(loading: boolean) {\n    state.loading = loading;\n  },\n\n  setError(error: string | null) {\n    state.error = error;\n  },\n\n  setChains(chains: EuclidChainConfig[]) {\n    state.chains = [...chains];\n    state.lastUpdated = Date.now();\n  },\n\n  setTokens(tokens: TokenMetadata[]) {\n    state.tokens = [...tokens];\n    state.lastUpdated = Date.now();\n  },\n\n  setPools(pools: PoolInfo[]) {\n    state.pools = [...pools];\n    state.lastUpdated = Date.now();\n  },\n\n  setPrices(prices: Record<string, number>) {\n    state.prices = { ...prices };\n    state.lastUpdated = Date.now();\n  },\n\n  addToken(token: TokenMetadata) {\n    state.tokens = [...state.tokens, token];\n  },\n\n  updateToken(tokenId: string, updates: Partial<TokenMetadata>) {\n    state.tokens = state.tokens.map(token =>\n      token.id === tokenId ? { ...token, ...updates } : token\n    );\n  },\n\n  clear() {\n    reset();\n  },\n};\n\n// Getters\nconst getters = {\n  getChain: (chainUID: string) =>\n    state.chains.find(chain => chain.chain_uid === chainUID),\n\n  getToken: (tokenId: string) =>\n    state.tokens.find(token => token.id === tokenId),\n\n  getTokensByChain: (chainUID: string) =>\n    state.tokens.filter(token => token.chain_uid === chainUID),\n\n  getPool: (poolId: string) =>\n    state.pools.find(pool => pool.pool_id === poolId),\n\n  getPoolsForTokenPair: (token1: string, token2: string) =>\n    state.pools.filter(pool =>\n      (pool.token_1 === token1 && pool.token_2 === token2) ||\n      (pool.token_1 === token2 && pool.token_2 === token1)\n    ),\n\n  getPrice: (tokenId: string) =>\n    state.prices[tokenId] || 0,\n\n  isDataStale: (maxAge: number = 5 * 60 * 1000) => { // 5 minutes default\n    if (!state.lastUpdated) return true;\n    return Date.now() - state.lastUpdated > maxAge;\n  },\n};\n\n// Proper store type definition extending BaseStore\nexport interface MarketStore extends BaseStore<MarketState> {\n  setLoading: (loading: boolean) => void;\n  setError: (error: string | null) => void;\n  setChains: (chains: EuclidChainConfig[]) => void;\n  setTokens: (tokens: TokenMetadata[]) => void;\n  setPools: (pools: PoolInfo[]) => void;\n  setPrices: (prices: Record<string, number>) => void;\n  addToken: (token: TokenMetadata) => void;\n  updateToken: (tokenId: string, updates: Partial<TokenMetadata>) => void;\n  clear: () => void;\n  getChain: (chainUID: string) => EuclidChainConfig | undefined;\n  getToken: (tokenId: string) => TokenMetadata | undefined;\n  getTokensByChain: (chainUID: string) => TokenMetadata[];\n  getPool: (poolId: string) => PoolInfo | undefined;\n  getPoolsForTokenPair: (token1: string, token2: string) => PoolInfo[];\n  getPrice: (tokenId: string) => number;\n  isDataStale: (maxAge?: number) => boolean;\n}\n\nexport const marketStore: MarketStore = {\n  state,\n  onChange,\n  reset,\n  dispose,\n  ...actions,\n  ...getters,\n};\n\n// Expose store globally for debugging and testing\nif (typeof window !== 'undefined') {\n  (window as unknown as { marketStore: MarketStore }).marketStore = marketStore;\n}\n\nexport type { MarketState, EuclidChainConfig, TokenMetadata, PoolInfo };\n"]}